# Bank-Server
Реализован многопоточный мини-банк с безопасной системой транзакций и поддержкой сетевого взаимодействия.

Особенности:
* Все операции потокобезопасны, включая одновременное использование одного аккаунта несколькими TCP-клиентами.
* Пользователи создаются "по требованию" и получают стартовый баланс 100 XTS.
* Поддерживается атомарное создание итератора и чтение состояния пользователя, исключающее гонки и потерю транзакций.
* Реализован полноценный TCP-сервер на `boost::asio::ip::tcp::iostream` с состоянием сессии, обрабатывающий несколько клиентов одновременно.
* Сервер реализует stateful-протокол, соответствующий спецификации и покрыт тестами.

Основные компоненты:
* `bank::ledger` — центральный гроссбух, хранящий всех пользователей и транзакции, потокобезопасен.
* `bank::user` — структура для работы с пользователем: получение баланса, истории, отправка перевода.
* `bank::transaction` — единица перевода между пользователями, с фиксацией времени и суммы.
* `bank::transfer_error` — кастомные исключения при некорректных транзакциях (например, нехватка средств).
* `bank::user_transactions_iterator` — блокирующий итератор, позволяющий наблюдать за приходом новых транзакций у пользователя в реальном времени.

## Инструкция по запуску
Перейти в папку проекта и построить его:
```bash
mkdir build && cd build && cmake .. && make
```
Приложение bank-server будет лежать в папке build

**Тестирование**\
Из папки build построить и запустить тесты:
```bash
make tests
```
```bash
./../test/run-test-data.sh
```

К проекту опубликована лишь часть тестов.\
Добавить свои юнит-тесты можно в файлы `bank_test.cpp` и `server_test.cpp`. Править скрипт или команды не требуется